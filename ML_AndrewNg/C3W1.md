# Course 3 Week 1: Unsupervised learning

## Clustering

### K-means algorithm
+ assign points to cluster centroids
+ find new cluster centroids

#### Implementation:
Repeat{
    &emsp;# assign points to cluster centroids
    &emsp;for i = 1 to m
    &emsp;$c^{(i)}$ := index (from 1 to $K$) of cluster
        &emsp;&emsp;centroid closest to $x^{(i)}$
    &emsp;# Move cluster centroid
    &emsp;for $k$=1 to $K$
        &emsp;&emsp;$\mu_k$ := averange(mean) of points assigned to cluster $k$
}
Distinct: $\min_k ||x^{(i)} - \mu_k||^2$

#### Cost function for K-means
$c^{(i)}$ = index of cluster to which example $x^{(i)}$ is currently assigned
$\mu_k$ = cluster centroid $k$
$\mu_{c^{(i)}}$ = cluster centroid of cluster to which example $x^{(i)}$ has been assigned 
**Cost function: distortion function**
$J(c^{(1)}, ..., c^{(m)},\mu_1, ..., \mu_K) = \frac{1}{m} \sum^m_{i=1}||x^{(i)} - \mu_k||^2$

#### Random initialization: 
Choose $K < m$
Randomly pick $K$ training examples.
Set $\mu_1, ..., \mu_k$ equal to these $K$ examples.
**Disadvantage and cost function**
![](Img/kmeansinitialization.png)

#### Choosing the value of K
Elbow method(not good):
Use different K to calculate cost function and choose the one with 'Elbow' (decrease from sharply to smoothly)

Evaluate K-means based on a metric for how well it performs for that later/downstream purpose.试多个K值，结合实际用途考虑

## Anomaly detection
### Density estimation
Dataset: ${x^{(1)}, x^{(2)}, ..., x^{(m)}}$
Is $x_{test}$ anomalous?

Model p(x):
+ $p(x_{test}) < \varepsilon$ -> Flag anomaly
+ $p(x_{test}) \geq \varepsilon$ -> "ok"

#### Fraud detection:
$x^{(i)} = $ features of user $i$'s activities
Model $p(x)$ from data.
Identify unusual users by checking which have $p(x) < \varepsilon$

### Gaussian (Normal) distribution
Center of curve: $\mu$
Standard deviation: $\sigma^2$
#### Density estimation
$p(x) = p(x_1; \mu_1,\sigma_1^2)*p(x_2; \mu_2,\sigma_2^2)*p(x_3)*...*p(x_n)$

### Anomaly detection algorithm
1. Choose $n$ features $x_i$ that you think might be indicative of anomalous examples
2. Fit parameters $\mu_1,...,\mu_n, \sigma_1^2,...,\sigma^2_n$
   $\mu_j = \frac{1}{m}\sum^m_{i=1}x_j^{(i)}$
   $\sigma_j^2 = \frac{1}{m}\sum^m_{i=1}(x_j^{(i)}-\mu_j)^2$
3. Given new example x, compute $p(x):$
   $p(x) = \prod^n_{j=1}p(x_j;\mu_j,\sigma_j^2)$